EESchema Schematic File Version 2  date 10/25/2011 1:56:18 AM
LIBS:power
LIBS:device
LIBS:transistors
LIBS:conn
LIBS:linear
LIBS:regul
LIBS:74xx
LIBS:cmos4000
LIBS:adc-dac
LIBS:memory
LIBS:xilinx
LIBS:special
LIBS:microcontrollers
LIBS:dsp
LIBS:microchip
LIBS:analog_switches
LIBS:motorola
LIBS:texas
LIBS:intel
LIBS:audio
LIBS:interface
LIBS:digital-audio
LIBS:philips
LIBS:display
LIBS:cypress
LIBS:siliconi
LIBS:opto
LIBS:atmel
LIBS:contrib
LIBS:valves
LIBS:PNPComponents
LIBS:MiataPNP-cache
EELAYER 25  0
EELAYER END
$Descr A4 11700 8267
encoding utf-8
Sheet 1 2
Title "Standalone ECU for 99 Miata using MicroSquirtModule"
Date "25 oct 2011"
Rev "1"
Comp ""
Comment1 ""
Comment2 ""
Comment3 ""
Comment4 ""
$EndDescr
Text Label 10400 6250 0    60   ~ 0
ChargeLight
Text Label 10400 6150 0    60   ~ 0
PhaseSense
Text Label 9500 6050 2    60   ~ 0
FieldDriver
Text Label 9500 6250 2    60   ~ 0
12VRAW
Text Label 9500 6150 2    60   ~ 0
FieldCtl
Wire Wire Line
	10350 6050 10850 6050
Wire Wire Line
	10350 6250 10850 6250
Wire Wire Line
	9550 6050 9150 6050
Wire Wire Line
	3100 2650 3450 2650
Wire Wire Line
	3100 2350 3450 2350
Wire Wire Line
	9950 4650 9400 4650
Wire Wire Line
	9950 4450 9400 4450
Wire Wire Line
	10000 5300 9650 5300
Wire Wire Line
	8050 6450 8450 6450
Wire Wire Line
	8050 6250 8450 6250
Wire Wire Line
	7000 6650 6650 6650
Wire Wire Line
	7000 6450 6650 6450
Wire Wire Line
	7000 6250 6650 6250
Wire Wire Line
	1450 6350 1350 6350
Connection ~ 1200 4950
Wire Wire Line
	1200 4950 1200 6250
Wire Wire Line
	8150 3100 8450 3100
Wire Wire Line
	8150 2700 8450 2700
Wire Wire Line
	8450 1500 8150 1500
Wire Wire Line
	7150 5200 6850 5200
Wire Wire Line
	6400 1400 6650 1400
Connection ~ 4650 4950
Wire Wire Line
	4550 4950 4950 4950
Wire Wire Line
	3100 1150 3350 1150
Connection ~ 3700 5750
Connection ~ 2550 5750
Wire Wire Line
	2550 5750 2550 5350
Connection ~ 1800 5750
Wire Wire Line
	3100 5750 3100 5500
Connection ~ 2300 4950
Wire Wire Line
	2250 4950 2550 4950
Connection ~ 1800 4950
Wire Wire Line
	1850 4950 1000 4950
Wire Wire Line
	8450 1400 8150 1400
Wire Wire Line
	6850 5100 7150 5100
Wire Wire Line
	9950 2900 8150 2900
Wire Wire Line
	9950 2400 9500 2400
Wire Wire Line
	9500 2400 9500 2500
Wire Wire Line
	9500 2500 9150 2500
Wire Wire Line
	8150 2100 8450 2100
Wire Wire Line
	4600 1400 4350 1400
Wire Wire Line
	4600 1200 4350 1200
Connection ~ 4450 1800
Wire Wire Line
	4450 1500 4450 1950
Connection ~ 4450 1600
Wire Wire Line
	4450 1700 4600 1700
Wire Wire Line
	5800 1800 6650 1800
Wire Wire Line
	6650 1700 6400 1700
Wire Wire Line
	6400 1700 6400 1600
Wire Wire Line
	6400 1600 5800 1600
Wire Wire Line
	5800 1200 6050 1200
Wire Wire Line
	8150 3600 8450 3600
Wire Wire Line
	7150 5300 6850 5300
Connection ~ 8150 4250
Connection ~ 8150 4450
Connection ~ 6650 4450
Wire Wire Line
	6650 4050 6650 4750
Connection ~ 6650 4250
Wire Wire Line
	8150 1800 8450 1800
Wire Wire Line
	6650 3750 6400 3750
Wire Wire Line
	6650 3500 6400 3500
Wire Wire Line
	8150 2800 8450 2800
Wire Wire Line
	8650 2500 8150 2500
Wire Wire Line
	9100 3000 9350 3000
Wire Wire Line
	3100 3000 3450 3000
Wire Wire Line
	3100 3500 3450 3500
Wire Wire Line
	1550 3150 1150 3150
Wire Wire Line
	1550 2950 1150 2950
Wire Wire Line
	1550 2150 1150 2150
Wire Wire Line
	1550 1750 1150 1750
Wire Wire Line
	1550 1550 1150 1550
Wire Wire Line
	1550 1350 900  1350
Wire Wire Line
	3100 2450 3450 2450
Wire Wire Line
	3100 3700 3450 3700
Wire Wire Line
	3100 3900 3450 3900
Wire Wire Line
	3100 3400 3450 3400
Wire Wire Line
	1400 1050 1400 1150
Connection ~ 1400 1050
Wire Wire Line
	1550 2350 1150 2350
Wire Wire Line
	8150 1200 8450 1200
Wire Wire Line
	8150 3300 8450 3300
Wire Wire Line
	8150 3200 8450 3200
Wire Wire Line
	8150 2400 8450 2400
Wire Wire Line
	8150 1600 8450 1600
Wire Wire Line
	8150 2000 8450 2000
Wire Wire Line
	8150 2600 8450 2600
Wire Wire Line
	8150 3700 8450 3700
Wire Wire Line
	8150 1300 8450 1300
Wire Wire Line
	8450 1300 8450 1050
Connection ~ 8450 1200
Wire Wire Line
	1400 1150 1550 1150
Wire Wire Line
	1150 1250 1550 1250
Wire Wire Line
	1550 1050 1150 1050
Wire Wire Line
	3100 3600 3450 3600
Wire Wire Line
	3100 3800 3450 3800
Wire Wire Line
	3100 3100 3450 3100
Wire Wire Line
	3100 1350 3350 1350
Wire Wire Line
	1550 1450 1250 1450
Wire Wire Line
	1250 1450 1250 1250
Connection ~ 1250 1250
Wire Wire Line
	1550 1650 1150 1650
Wire Wire Line
	1550 2050 1150 2050
Wire Wire Line
	1550 2250 1150 2250
Wire Wire Line
	1550 3050 1150 3050
Wire Wire Line
	1550 3250 1150 3250
Wire Wire Line
	3100 3300 3450 3300
Wire Wire Line
	8150 2200 8450 2200
Connection ~ 6650 4150
Connection ~ 6650 4350
Wire Wire Line
	6650 4750 8150 4750
Connection ~ 8150 4350
Wire Wire Line
	8150 4750 8150 4050
Connection ~ 8150 4150
Wire Wire Line
	5800 1100 6050 1100
Wire Wire Line
	5800 1500 6650 1500
Wire Wire Line
	5800 1700 6350 1700
Wire Wire Line
	6350 1700 6350 2000
Wire Wire Line
	6350 2000 6650 2000
Wire Wire Line
	4450 1500 4600 1500
Wire Wire Line
	4450 1600 4600 1600
Wire Wire Line
	4600 1800 4450 1800
Connection ~ 4450 1700
Wire Wire Line
	4600 1100 4350 1100
Wire Wire Line
	4600 1300 4350 1300
Wire Wire Line
	8150 2300 8450 2300
Wire Wire Line
	8600 3000 8150 3000
Connection ~ 1550 4950
Wire Wire Line
	1550 5750 1550 5450
Wire Wire Line
	2300 5750 2300 5350
Connection ~ 2300 5750
Wire Wire Line
	3700 5350 3700 5750
Connection ~ 3100 5750
Wire Wire Line
	3700 4950 4050 4950
Wire Wire Line
	4650 5350 4650 5750
Wire Wire Line
	1450 6450 1150 6450
Wire Wire Line
	10350 2900 10650 2900
Wire Wire Line
	6650 1600 6550 1600
Wire Wire Line
	6550 1600 6550 1400
Connection ~ 6550 1400
Wire Wire Line
	4450 1950 4100 1950
Wire Wire Line
	8150 1700 8450 1700
Wire Wire Line
	4650 5750 1350 5750
Wire Wire Line
	1350 5750 1350 6350
Connection ~ 1550 5750
Wire Wire Line
	1200 6250 1450 6250
Wire Wire Line
	7000 6150 6650 6150
Wire Wire Line
	7000 6350 6650 6350
Wire Wire Line
	7000 6550 6650 6550
Wire Wire Line
	8050 6150 8450 6150
Wire Wire Line
	8050 6350 8450 6350
Wire Wire Line
	10000 5200 9650 5200
Wire Wire Line
	10000 5400 9650 5400
Wire Wire Line
	9950 4550 9400 4550
Wire Wire Line
	3100 2150 3450 2150
Wire Wire Line
	3100 2850 3450 2850
Wire Wire Line
	9550 6150 9150 6150
Wire Wire Line
	9550 6250 9150 6250
Wire Wire Line
	10350 6150 10850 6150
$Comp
L CONN_3X2 P?
U 1 1 4EA5B563
P 9950 6200
F 0 "P?" H 9950 6450 50  0000 C CNN
F 1 "CONN_3X2" V 9950 6250 40  0000 C CNN
	1    9950 6200
	1    0    0    -1  
$EndComp
Text Notes 9400 6450 0    60   ~ 0
Jumpers for NA/NB alternator\nTop NB, Bottom NA
Text Label 3150 2650 0    60   ~ 0
PhaseSense
Text Label 3150 2850 0    60   ~ 0
Neutral
Text Label 3150 2350 0    60   ~ 0
ChargeLight
Text Label 3150 2150 0    60   ~ 0
FieldCtl
Text Label 5900 1100 0    60   ~ 0
5V
Text Notes 9300 4850 0    60   ~ 0
Serial Connector via 3.5mm plug
Text Label 9500 4550 0    60   ~ 0
SerialTX
Text Label 9500 4650 0    60   ~ 0
GND
Text Label 9500 4450 0    60   ~ 0
SerialRX
$Comp
L CONN_3 K2
U 1 1 4EA319A1
P 10300 4550
F 0 "K2" V 10250 4550 50  0000 C CNN
F 1 "3.5mm" V 10350 4550 40  0000 C CNN
F 2 "TO220" H 10300 4550 60  0001 C CNN
	1    10300 4550
	1    0    0    -1  
$EndComp
Text Label 9950 5400 2    60   ~ 0
GND
Text Label 9950 5300 2    60   ~ 0
OilPressure
Text Label 9950 5200 2    60   ~ 0
WB
$Comp
L CONN_3 K3
U 1 1 4EA3176F
P 10350 5300
F 0 "K3" V 10300 5300 50  0000 C CNN
F 1 "CONN_3" V 10400 5300 40  0000 C CNN
F 2 "External3" H 10350 5300 60  0001 C CNN
	1    10350 5300
	1    0    0    -1  
$EndComp
Text Label 8250 1700 0    60   ~ 0
SerialTx
Text Label 8250 1500 0    60   ~ 0
SerialRx
Text Label 8250 1400 0    60   ~ 0
MAP
Text Label 8100 6450 0    60   ~ 0
CANL
Text Label 8100 6350 0    60   ~ 0
CANH
Text Label 8100 6250 0    60   ~ 0
GND
Text Label 8100 6150 0    60   ~ 0
5V
Text Label 6950 6650 2    60   ~ 0
IGN1
Text Label 6950 6550 2    60   ~ 0
IGN2
Text Label 6950 6450 2    60   ~ 0
KnockSensor
Text Label 6950 6350 2    60   ~ 0
VSSSignal
Text Label 6950 6250 2    60   ~ 0
IAC
$Sheet
S 7000 6050 1050 750 
U 4EA3092F
F0 "CoProcessor" 60
F1 "CoProcessor.sch" 60
F2 "ExtraDriver" I L 7000 6150 60 
F3 "IAC" I L 7000 6250 60 
F4 "CANL" I R 8050 6450 60 
F5 "KnockSensor" I L 7000 6450 60 
F6 "Ignition2" I L 7000 6550 60 
F7 "Ignition1" I L 7000 6650 60 
F8 "VSSSignal" I L 7000 6350 60 
F9 "5V" I R 8050 6150 60 
F10 "GND" I R 8050 6250 60 
F11 "CANH" I R 8050 6350 60 
$EndSheet
Text Label 8250 3100 0    60   ~ 0
Purge
Text Notes 8800 3250 0    60   ~ 0
Idle Driver used for Purge
Text Label 8250 2700 0    60   ~ 0
OilPressure
Text Label 1000 4950 0    60   ~ 0
12VRAW
Text Label 6450 1400 0    60   ~ 0
GND
Text Label 10400 2900 0    60   ~ 0
Clutch
$Comp
L DIODE D6
U 1 1 4EA08EF7
P 10150 2900
F 0 "D6" H 10150 3000 40  0000 C CNN
F 1 "1N4001" H 10150 2800 40  0000 C CNN
F 2 "D4" H 10150 2900 60  0001 C CNN
	1    10150 2900
	1    0    0    -1  
$EndComp
$Comp
L CONN_3 K1
U 1 1 4E9FA343
P 1800 6350
F 0 "K1" V 1750 6350 50  0000 C CNN
F 1 "CONN_3" V 1850 6350 40  0000 C CNN
F 2 "JACK_ALIM" H 1800 6350 60  0001 C CNN
F 4 "CP-102A-ND" V 1800 6350 60  0001 C CNN "Digikey"
	1    1800 6350
	1    0    0    -1  
$EndComp
$Comp
L MPX4250AP U5
U 1 1 4E9F35B8
P 7750 5350
F 0 "U5" H 7500 5700 60  0000 C CNN
F 1 "MPX4250AP" H 7650 5000 60  0000 C CNN
F 2 "MPX4250AP" H 7400 5600 60  0001 C CNN
	1    7750 5350
	1    0    0    -1  
$EndComp
Text Notes 9700 5600 0    60   ~ 0
External Connector
Text Notes 1150 6700 0    60   ~ 0
External Power
Text Label 4950 4950 2    60   ~ 0
5V
$Comp
L FUSE F1
U 1 1 4E9E1CF4
P 4300 4950
F 0 "F1" H 4400 5000 40  0000 C CNN
F 1 "FUSE" H 4200 4900 40  0000 C CNN
F 2 "C2" H 4300 4950 60  0001 C CNN
F 4 "V3-F1" H 4300 4950 60  0001 C CNN "Digikey"
	1    4300 4950
	1    0    0    -1  
$EndComp
Text Label 3800 5750 0    60   ~ 0
GND
Text Notes 2200 5900 0    60   ~ 0
Copy of V3 Board 5V Supply\n(scavange parts)
$Comp
L LM2937 U2
U 1 1 4E9DC29E
P 3100 5050
F 0 "U2" H 2900 5300 60  0000 C CNN
F 1 "LM2937" H 3250 5300 60  0000 C CNN
F 2 "TO220" H 2800 5200 60  0001 C CNN
F 4 "V3-U5" H 3100 5050 60  0001 C CNN "Digikey"
	1    3100 5050
	1    0    0    -1  
$EndComp
$Comp
L ZENER D4
U 1 1 4E9DC155
P 2300 5150
F 0 "D4" H 2300 5250 50  0000 C CNN
F 1 "22V 1W" H 2300 5050 40  0000 C CNN
F 2 "D4" H 2300 5150 60  0001 C CNN
F 4 "V3-D12" H 2300 5150 60  0001 C CNN "Digikey"
	1    2300 5150
	0    -1   -1   0   
$EndComp
$Comp
L DIODE D3
U 1 1 4E9DC145
P 2050 4950
F 0 "D3" H 2050 5050 40  0000 C CNN
F 1 "1N4001" H 2050 4850 40  0000 C CNN
F 2 "D4" H 2050 4950 60  0001 C CNN
F 4 "V3-D10" H 2050 4950 60  0001 C CNN "Digikey"
	1    2050 4950
	1    0    0    -1  
$EndComp
$Comp
L ZENER D2
U 1 1 4E9DC135
P 1800 5550
F 0 "D2" H 1800 5650 50  0000 C CNN
F 1 "12V 1W" H 1800 5450 40  0000 C CNN
F 2 "D4" H 1800 5550 60  0001 C CNN
F 4 "V3-D13" H 1800 5550 60  0001 C CNN "Digikey"
	1    1800 5550
	0    1    1    0   
$EndComp
$Comp
L DIODE D1
U 1 1 4E9DC128
P 1800 5150
F 0 "D1" H 1800 5250 40  0000 C CNN
F 1 "1N4001" H 1800 5050 40  0000 C CNN
F 2 "D4" H 1800 5150 60  0001 C CNN
F 4 "V3-D11" H 1800 5150 60  0001 C CNN "Digikey"
	1    1800 5150
	0    -1   -1   0   
$EndComp
$Comp
L R M1
U 1 1 4E9DC114
P 1550 5200
F 0 "M1" V 1630 5200 50  0000 C CNN
F 1 "MOV" V 1550 5200 50  0000 C CNN
F 2 "R4" H 1550 5200 60  0001 C CNN
F 4 "V3-MOV1" V 1550 5200 60  0001 C CNN "Digikey"
	1    1550 5200
	1    0    0    -1  
$EndComp
$Comp
L ZENER D5
U 1 1 4E9BF1E2
P 4650 5150
F 0 "D5" H 4650 5250 50  0000 C CNN
F 1 "5.6V 1W" H 4650 5050 40  0000 C CNN
F 2 "D4" H 4650 5150 60  0001 C CNN
F 4 "V3-D19" H 4650 5150 60  0001 C CNN "Digikey"
	1    4650 5150
	0    -1   -1   0   
$EndComp
$Comp
L CP1 C1
U 1 1 4E9BF19C
P 2550 5150
F 0 "C1" H 2600 5250 50  0000 L CNN
F 1 "33uF" H 2600 5050 50  0000 L CNN
F 2 "C2V8" H 2550 5150 60  0001 C CNN
F 4 "V3-C16" H 2550 5150 60  0001 C CNN "Digikey"
	1    2550 5150
	1    0    0    -1  
$EndComp
$Comp
L CP1 C2
U 1 1 4E9BF18D
P 3700 5150
F 0 "C2" H 3750 5250 50  0000 L CNN
F 1 "33uF" H 3750 5050 50  0000 L CNN
F 2 "C2V8" H 3700 5150 60  0001 C CNN
F 4 "V3-C17" H 3700 5150 60  0001 C CNN "Digikey"
	1    3700 5150
	1    0    0    -1  
$EndComp
$Comp
L R R3
U 1 1 4E9BD276
P 9950 2650
F 0 "R3" V 10030 2650 50  0000 C CNN
F 1 "10K" V 9950 2650 50  0000 C CNN
F 2 "R4" H 9950 2650 60  0001 C CNN
	1    9950 2650
	-1   0    0    1   
$EndComp
Text Label 8250 2900 0    60   ~ 0
Launch
Text Label 8250 2300 0    60   ~ 0
CANL
Text Label 8250 2100 0    60   ~ 0
CANH
Text Label 6000 1800 0    60   ~ 0
sig4
Text Label 6000 1700 0    60   ~ 0
sig3
Text Label 6000 1600 0    60   ~ 0
sig2
Text Label 6000 1500 0    60   ~ 0
sig1
Text Label 4400 1400 0    60   ~ 0
INJ4
Text Label 4400 1300 0    60   ~ 0
INJ3
Text Label 4400 1200 0    60   ~ 0
INJ2
Text Label 4400 1100 0    60   ~ 0
INJ1
Text Label 4450 1950 2    60   ~ 0
BIGGND
Text Label 5900 1200 0    60   ~ 0
GND
$Comp
L PHBOARD U3
U 1 1 4E9B54C8
P 5200 1400
F 0 "U3" H 5000 1800 60  0000 C CNN
F 1 "PHBOARD" H 5150 900 60  0000 C CNN
F 2 "PHBOARD" H 5200 1400 60  0001 C CNN
	1    5200 1400
	-1   0    0    -1  
$EndComp
Text Label 8250 3600 0    60   ~ 0
WB
Text Label 6900 5300 0    60   ~ 0
Vref
Text Label 6900 5200 0    60   ~ 0
GND
Text Label 6900 5100 0    60   ~ 0
MAP
Text Label 7350 4750 0    60   ~ 0
GND
Text Label 8250 2200 0    60   ~ 0
FAN
Text Label 8250 1800 0    60   ~ 0
CEL
Text Label 6450 3750 0    60   ~ 0
IGN1
Text Label 6450 3500 0    60   ~ 0
IGN2
Text Label 8250 2800 0    60   ~ 0
FuelPressure
Text Label 9350 2500 0    60   ~ 0
5V
$Comp
L R R2
U 1 1 4E97EB9D
P 8900 2500
F 0 "R2" V 8980 2500 50  0000 C CNN
F 1 "470" V 8900 2500 50  0000 C CNN
F 2 "R4" H 8900 2500 60  0001 C CNN
	1    8900 2500
	0    1    1    0   
$EndComp
Text Label 9200 3000 0    60   ~ 0
12VRAW
$Comp
L R R1
U 1 1 4E97EB45
P 8850 3000
F 0 "R1" V 8930 3000 50  0000 C CNN
F 1 "470" V 8850 3000 50  0000 C CNN
F 2 "R4" H 8850 3000 60  0001 C CNN
	1    8850 3000
	0    1    1    0   
$EndComp
Text Label 3150 3000 0    60   ~ 0
FuelPressure
Text Label 3150 3300 0    60   ~ 0
VSSSignal
Text Label 3150 3500 0    60   ~ 0
KnockSensor
Text Label 3150 3900 0    60   ~ 0
TACH
Text Label 3150 3800 0    60   ~ 0
CRANK
Text Label 3150 3700 0    60   ~ 0
Vref
Text Label 3150 3600 0    60   ~ 0
CAM
Text Label 3150 3400 0    60   ~ 0
CLT
Text Label 3150 3100 0    60   ~ 0
IAT
Text Label 3150 2450 0    60   ~ 0
FAN
Text Label 3150 1350 0    60   ~ 0
CEL
Text Label 1200 3250 0    60   ~ 0
INJ4
Text Label 1200 3150 0    60   ~ 0
INJ3
Text Label 1200 3050 0    60   ~ 0
INJ2
Text Label 1200 2950 0    60   ~ 0
INJ1
Text Label 1200 2250 0    60   ~ 0
FuelPump
Text Label 1200 2150 0    60   ~ 0
IAC
Text Label 1200 2050 0    60   ~ 0
Purge
Text Label 1200 1750 0    60   ~ 0
Clutch
Text Label 1200 1650 0    60   ~ 0
IGN2
Text Label 1200 1550 0    60   ~ 0
IGN1
Text Label 950  1350 0    60   ~ 0
TPS
Text Label 1150 1050 0    60   ~ 0
BIGGND
Text Label 1300 1250 0    60   ~ 0
GND
Text Label 1200 2350 0    60   ~ 0
12VRAW
Text Label 3150 1150 0    60   ~ 0
12VRAW
Text Label 8450 1200 0    60   ~ 0
12VRAW
Text Label 8250 3700 0    60   ~ 0
TACH
Text Label 8250 3300 0    60   ~ 0
FuelPump
Text Label 8250 2600 0    60   ~ 0
Vref
Text Label 8250 3200 0    60   ~ 0
CRANK
Text Label 8250 2500 0    60   ~ 0
CAM
Text Label 8250 2400 0    60   ~ 0
TPS
Text Label 8250 2000 0    60   ~ 0
MAT
Text Label 8250 1600 0    60   ~ 0
CLT
$Comp
L USMODULE U4
U 1 1 4E967618
P 7400 2750
F 0 "U4" H 7000 4450 60  0000 C CNN
F 1 "USMODULE" H 7650 900 60  0000 C CNN
F 2 "USMODULE" H 7650 4450 60  0001 C CNN
	1    7400 2750
	1    0    0    -1  
$EndComp
$Comp
L ECU U1
U 1 1 4E9651F0
P 2150 2500
F 0 "U1" H 1900 4050 60  0000 C CNN
F 1 "ECU" H 2650 450 60  0000 C CNN
F 2 "MiataECU" H 2450 4050 60  0001 C CNN
	1    2150 2500
	1    0    0    -1  
$EndComp
$EndSCHEMATC
