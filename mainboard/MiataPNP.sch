EESchema Schematic File Version 2  date 10/29/2011 4:15:13 AM
LIBS:power
LIBS:device
LIBS:transistors
LIBS:conn
LIBS:linear
LIBS:regul
LIBS:74xx
LIBS:cmos4000
LIBS:adc-dac
LIBS:memory
LIBS:xilinx
LIBS:special
LIBS:microcontrollers
LIBS:dsp
LIBS:microchip
LIBS:analog_switches
LIBS:motorola
LIBS:texas
LIBS:intel
LIBS:audio
LIBS:interface
LIBS:digital-audio
LIBS:philips
LIBS:display
LIBS:cypress
LIBS:siliconi
LIBS:opto
LIBS:atmel
LIBS:contrib
LIBS:valves
LIBS:PNPComponents
LIBS:MiataPNP-cache
EELAYER 25  0
EELAYER END
$Descr A4 11700 8267
encoding utf-8
Sheet 1 10
Title "Standalone ECU for 99 Miata using MicroSquirtModule"
Date "29 oct 2011"
Rev "1"
Comp ""
Comment1 ""
Comment2 ""
Comment3 ""
Comment4 ""
$EndDescr
Text Label 2700 5600 0    60   ~ 0
Phase12V
Text Label 4600 7000 2    60   ~ 0
FieldDriver
Wire Wire Line
	4650 7000 4300 7000
Wire Wire Line
	5450 5550 5850 5550
Wire Wire Line
	4900 4800 4450 4800
Connection ~ 9800 2300
Wire Wire Line
	9950 2300 9800 2300
Wire Wire Line
	8100 5950 7700 5950
Wire Wire Line
	7700 5750 8100 5750
Wire Wire Line
	8100 5850 7700 5850
Wire Wire Line
	4900 5550 4500 5550
Wire Wire Line
	4850 1150 4550 1150
Wire Wire Line
	5550 1300 5900 1300
Wire Wire Line
	5550 1000 5900 1000
Wire Wire Line
	2650 5600 3150 5600
Wire Wire Line
	2650 5800 3150 5800
Wire Wire Line
	1850 5600 1450 5600
Wire Wire Line
	3100 2650 3450 2650
Wire Wire Line
	3100 2350 3450 2350
Wire Wire Line
	8100 5300 7550 5300
Wire Wire Line
	8100 5100 7550 5100
Wire Wire Line
	8100 6600 7750 6600
Wire Wire Line
	5700 6700 6100 6700
Wire Wire Line
	5700 6500 6100 6500
Wire Wire Line
	4650 6900 4300 6900
Wire Wire Line
	4650 6700 4300 6700
Wire Wire Line
	4650 6500 4300 6500
Wire Wire Line
	8800 3000 9100 3000
Wire Wire Line
	8800 2600 9100 2600
Wire Wire Line
	9100 1400 8800 1400
Wire Wire Line
	10100 5250 9800 5250
Wire Wire Line
	7050 1300 7300 1300
Wire Wire Line
	3100 1150 3350 1150
Wire Wire Line
	9100 1300 8800 1300
Wire Wire Line
	9800 5150 10100 5150
Wire Wire Line
	9950 2800 8800 2800
Wire Wire Line
	8800 2000 9100 2000
Wire Wire Line
	7300 1600 6850 1600
Wire Wire Line
	8800 3500 9100 3500
Wire Wire Line
	10100 5350 9800 5350
Connection ~ 8800 4150
Connection ~ 8800 4350
Connection ~ 7300 4350
Wire Wire Line
	7300 3950 7300 4650
Connection ~ 7300 4150
Wire Wire Line
	8800 1700 9100 1700
Wire Wire Line
	7300 3650 7050 3650
Wire Wire Line
	7300 3400 7050 3400
Wire Wire Line
	8800 2700 9100 2700
Wire Wire Line
	9100 2400 8800 2400
Wire Wire Line
	9600 2900 9750 2900
Wire Wire Line
	3100 3000 3450 3000
Wire Wire Line
	3100 3500 3450 3500
Wire Wire Line
	1550 3150 1150 3150
Wire Wire Line
	1550 2950 1150 2950
Wire Wire Line
	1550 2150 1150 2150
Wire Wire Line
	1550 1750 1150 1750
Wire Wire Line
	1550 1550 1150 1550
Wire Wire Line
	1550 1350 900  1350
Wire Wire Line
	3100 2450 3450 2450
Wire Wire Line
	3100 3700 3450 3700
Wire Wire Line
	3100 3900 3450 3900
Wire Wire Line
	3100 3400 3450 3400
Wire Wire Line
	1400 1050 1400 1150
Connection ~ 1400 1050
Wire Wire Line
	1550 2350 1150 2350
Wire Wire Line
	8800 1100 9100 1100
Wire Wire Line
	8800 3200 9100 3200
Wire Wire Line
	8800 3100 9100 3100
Wire Wire Line
	8800 2300 9100 2300
Wire Wire Line
	8800 1500 9100 1500
Wire Wire Line
	8800 1900 9100 1900
Wire Wire Line
	8800 2500 9100 2500
Wire Wire Line
	8800 3600 9100 3600
Wire Wire Line
	8800 1200 9100 1200
Wire Wire Line
	9100 1200 9100 950 
Connection ~ 9100 1100
Wire Wire Line
	1400 1150 1550 1150
Wire Wire Line
	1150 1250 1550 1250
Wire Wire Line
	1550 1050 1150 1050
Wire Wire Line
	3100 3600 3450 3600
Wire Wire Line
	3100 3800 3450 3800
Wire Wire Line
	3100 3100 3450 3100
Wire Wire Line
	3100 1350 3350 1350
Wire Wire Line
	1550 1450 1250 1450
Wire Wire Line
	1250 1450 1250 1250
Connection ~ 1250 1250
Wire Wire Line
	1550 1650 1150 1650
Wire Wire Line
	1550 2050 1150 2050
Wire Wire Line
	1550 2250 1150 2250
Wire Wire Line
	1550 3050 1150 3050
Wire Wire Line
	1550 3250 1150 3250
Wire Wire Line
	3100 3300 3450 3300
Wire Wire Line
	8800 2100 9100 2100
Connection ~ 7300 4050
Connection ~ 7300 4250
Wire Wire Line
	7300 4650 8800 4650
Connection ~ 8800 4250
Wire Wire Line
	8800 4650 8800 3950
Connection ~ 8800 4050
Wire Wire Line
	6850 1400 7300 1400
Wire Wire Line
	6850 1900 7300 1900
Wire Wire Line
	8800 2200 9100 2200
Wire Wire Line
	9100 2900 8800 2900
Wire Wire Line
	10350 2800 10600 2800
Wire Wire Line
	7300 1500 7200 1500
Wire Wire Line
	7200 1500 7200 1300
Connection ~ 7200 1300
Wire Wire Line
	8800 1600 9100 1600
Wire Wire Line
	4650 6400 4300 6400
Wire Wire Line
	4650 6600 4300 6600
Wire Wire Line
	4650 6800 4300 6800
Wire Wire Line
	5700 6400 6100 6400
Wire Wire Line
	5700 6600 6100 6600
Wire Wire Line
	8100 6500 7750 6500
Wire Wire Line
	8100 6700 7750 6700
Wire Wire Line
	8100 5200 7550 5200
Wire Wire Line
	3100 2150 3450 2150
Wire Wire Line
	3100 2850 3450 2850
Wire Wire Line
	1850 5700 1450 5700
Wire Wire Line
	1850 5800 1450 5800
Wire Wire Line
	2650 5700 3150 5700
Wire Wire Line
	7300 1700 6850 1700
Wire Wire Line
	5550 1150 5900 1150
Wire Wire Line
	4850 1000 4550 1000
Wire Wire Line
	4850 1300 4550 1300
Wire Wire Line
	4850 2200 4550 2200
Wire Wire Line
	4850 1900 4550 1900
Wire Wire Line
	5550 2050 5900 2050
Wire Wire Line
	5550 1900 5900 1900
Wire Wire Line
	5550 2200 5900 2200
Wire Wire Line
	4850 2050 4550 2050
Wire Wire Line
	4850 3850 4550 3850
Wire Wire Line
	5550 4000 5900 4000
Wire Wire Line
	5550 3700 5900 3700
Wire Wire Line
	5550 3850 5900 3850
Wire Wire Line
	4850 3700 4550 3700
Wire Wire Line
	4850 4000 4550 4000
Wire Wire Line
	4850 3100 4550 3100
Wire Wire Line
	4850 2800 4550 2800
Wire Wire Line
	5550 2950 5900 2950
Wire Wire Line
	5550 2800 5900 2800
Wire Wire Line
	5550 3100 5900 3100
Wire Wire Line
	4850 2950 4550 2950
Wire Wire Line
	4900 5700 4500 5700
Wire Wire Line
	9600 2400 9800 2400
Wire Wire Line
	9800 2400 9800 2000
Wire Wire Line
	4900 4600 4450 4600
Wire Wire Line
	4900 5400 4500 5400
Wire Wire Line
	5700 6800 6100 6800
Text Label 4600 6400 2    60   ~ 0
Phase12V
Text Label 5750 6800 0    60   ~ 0
12V
$Sheet
S 4900 5300 550  500 
U 4EA86F7C
F0 "PowerSupply" 60
F1 "PowerSupply.sch" 60
F2 "5V" I R 5450 5550 60 
F3 "12V" I L 4900 5550 60 
F4 "GND" I L 4900 5700 60 
F5 "12VRAW" I L 4900 5400 60 
$EndSheet
Text Label 4850 5550 2    60   ~ 0
12V
Text Label 4850 5400 2    60   ~ 0
12VRAW
Text Label 4850 4800 2    60   ~ 0
BIGGND
Text Label 4850 4600 2    60   ~ 0
Flyback
$Sheet
S 4900 4450 550  500 
U 4EA87E8C
F0 "Flyback" 60
F1 "flyback.sch" 60
F2 "Gnd" I L 4900 4800 60 
F3 "Flyback" I L 4900 4600 60 
$EndSheet
Text Label 8050 5850 2    60   ~ 0
GND
Text Label 8050 5750 2    60   ~ 0
12VRAW
$Comp
L CONN_3 K2
U 1 1 4EA870DE
P 8450 5850
F 0 "K2" V 8400 5850 50  0000 C CNN
F 1 "CONN_3" V 8500 5850 40  0000 C CNN
F 2 "JACK_ALIM" H 8450 5850 60  0001 C CNN
F 4 "CP-102A-ND" V 8450 5850 60  0001 C CNN "Digikey"
	1    8450 5850
	1    0    0    -1  
$EndComp
Text Notes 7800 6200 0    60   ~ 0
External Power
Text Label 5500 5550 0    60   ~ 0
5V
Text Label 4850 5700 2    60   ~ 0
GND
$Sheet
S 4850 2650 700  550 
U 4EA86E88
F0 "Inj3" 60
F1 "InjectorDriver.sch" 60
F2 "INJGND" I L 4850 2950 60 
F3 "INJ" I L 4850 2800 60 
F4 "FB" I L 4850 3100 60 
F5 "GND" I R 5550 3100 60 
F6 "VCC" I R 5550 2800 60 
F7 "IN" I R 5550 2950 60 
$EndSheet
Text Label 4800 2800 2    60   ~ 0
INJ3
Text Label 4800 2950 2    60   ~ 0
BIGGND
Text Label 4800 3100 2    60   ~ 0
Flyback
Text Label 5650 2800 0    60   ~ 0
5V
Text Label 5650 2950 0    60   ~ 0
sig3
Text Label 5650 3100 0    60   ~ 0
GND
Text Label 5650 4000 0    60   ~ 0
GND
Text Label 5650 3850 0    60   ~ 0
sig4
Text Label 5650 3700 0    60   ~ 0
5V
Text Label 4800 4000 2    60   ~ 0
Flyback
Text Label 4800 3850 2    60   ~ 0
BIGGND
Text Label 4800 3700 2    60   ~ 0
INJ4
$Sheet
S 4850 3550 700  550 
U 4EA86E87
F0 "Inj4" 60
F1 "InjectorDriver.sch" 60
F2 "INJGND" I L 4850 3850 60 
F3 "INJ" I L 4850 3700 60 
F4 "FB" I L 4850 4000 60 
F5 "GND" I R 5550 4000 60 
F6 "VCC" I R 5550 3700 60 
F7 "IN" I R 5550 3850 60 
$EndSheet
$Sheet
S 4850 1750 700  550 
U 4EA86E5C
F0 "Inj2" 60
F1 "InjectorDriver.sch" 60
F2 "INJGND" I L 4850 2050 60 
F3 "INJ" I L 4850 1900 60 
F4 "FB" I L 4850 2200 60 
F5 "GND" I R 5550 2200 60 
F6 "VCC" I R 5550 1900 60 
F7 "IN" I R 5550 2050 60 
$EndSheet
Text Label 4800 1900 2    60   ~ 0
INJ2
Text Label 4800 2050 2    60   ~ 0
BIGGND
Text Label 4800 2200 2    60   ~ 0
Flyback
Text Label 5650 1900 0    60   ~ 0
5V
Text Label 5650 2050 0    60   ~ 0
sig2
Text Label 5650 2200 0    60   ~ 0
GND
Text Label 5650 1300 0    60   ~ 0
GND
Text Label 5650 1150 0    60   ~ 0
sig1
Text Label 5650 1000 0    60   ~ 0
5V
Text Label 4800 1300 2    60   ~ 0
Flyback
Text Label 4800 1150 2    60   ~ 0
BIGGND
Text Label 4800 1000 2    60   ~ 0
INJ1
$Sheet
S 4850 850  700  550 
U 4EA86CCC
F0 "Inj1" 60
F1 "InjectorDriver.sch" 60
F2 "INJGND" I L 4850 1150 60 
F3 "INJ" I L 4850 1000 60 
F4 "FB" I L 4850 1300 60 
F5 "GND" I R 5550 1300 60 
F6 "VCC" I R 5550 1000 60 
F7 "IN" I R 5550 1150 60 
$EndSheet
Text Label 2700 5800 0    60   ~ 0
ChargeLight
Text Label 2700 5700 0    60   ~ 0
PhaseSense
Text Label 1800 5600 2    60   ~ 0
FieldDriver
Text Label 1800 5800 2    60   ~ 0
12VRAW
Text Label 1800 5700 2    60   ~ 0
FieldCtl
$Comp
L CONN_3X2 P1
U 1 1 4EA5B563
P 2250 5750
F 0 "P1" H 2250 6000 50  0000 C CNN
F 1 "CONN_3X2" V 2250 5800 40  0000 C CNN
F 2 "PIN_ARRAY_3x2" H 2250 5750 60  0001 C CNN
	1    2250 5750
	1    0    0    -1  
$EndComp
Text Notes 1700 6000 0    60   ~ 0
Jumpers for NA/NB alternator\nTop NB, Bottom NA
Text Label 3150 2650 0    60   ~ 0
PhaseSense
Text Label 3150 2850 0    60   ~ 0
Neutral
Text Label 3150 2350 0    60   ~ 0
ChargeLight
Text Label 3150 2150 0    60   ~ 0
FieldCtl
Text Notes 7450 5500 0    60   ~ 0
Serial Connector via 3.5mm plug
Text Label 7650 5200 0    60   ~ 0
SerialTX
Text Label 7650 5300 0    60   ~ 0
GND
Text Label 7650 5100 0    60   ~ 0
SerialRX
$Comp
L CONN_3 K1
U 1 1 4EA319A1
P 8450 5200
F 0 "K1" V 8400 5200 50  0000 C CNN
F 1 "3.5mm" V 8500 5200 40  0000 C CNN
F 2 "MiniJack" H 8450 5200 60  0001 C CNN
F 4 "CP1-3523N-ND" V 8450 5200 60  0001 C CNN "Digikey"
	1    8450 5200
	1    0    0    -1  
$EndComp
Text Label 8050 6700 2    60   ~ 0
GND
Text Label 8050 6600 2    60   ~ 0
OilPressure
Text Label 8050 6500 2    60   ~ 0
WB
$Comp
L CONN_3 K3
U 1 1 4EA3176F
P 8450 6600
F 0 "K3" V 8400 6600 50  0000 C CNN
F 1 "CONN_3" V 8500 6600 40  0000 C CNN
F 2 "External3" H 8450 6600 60  0001 C CNN
	1    8450 6600
	1    0    0    -1  
$EndComp
Text Label 8900 1600 0    60   ~ 0
SerialTx
Text Label 8900 1400 0    60   ~ 0
SerialRx
Text Label 8900 1300 0    60   ~ 0
MAP
Text Label 5750 6700 0    60   ~ 0
CANL
Text Label 5750 6600 0    60   ~ 0
CANH
Text Label 5750 6500 0    60   ~ 0
GND
Text Label 5750 6400 0    60   ~ 0
5V
Text Label 4600 6900 2    60   ~ 0
IGN1
Text Label 4600 6800 2    60   ~ 0
IGN2
Text Label 4600 6700 2    60   ~ 0
KnockSensor
Text Label 4600 6600 2    60   ~ 0
VSSSignal
Text Label 4600 6500 2    60   ~ 0
IAC
$Sheet
S 4650 6300 1050 800 
U 4EA3092F
F0 "CoProcessor" 60
F1 "CoProcessor.sch" 60
F2 "IAC" I L 4650 6500 60 
F3 "CANL" I R 5700 6700 60 
F4 "KnockSensor" I L 4650 6700 60 
F5 "Ignition2" I L 4650 6800 60 
F6 "Ignition1" I L 4650 6900 60 
F7 "VSSSignal" I L 4650 6600 60 
F8 "5V" I R 5700 6400 60 
F9 "GND" I R 5700 6500 60 
F10 "CANH" I R 5700 6600 60 
F11 "12V" I R 5700 6800 60 
F12 "Phase12V" I L 4650 6400 60 
F13 "FieldDriver" I L 4650 7000 60 
$EndSheet
Text Label 8900 3000 0    60   ~ 0
Purge
Text Notes 9450 3150 0    60   ~ 0
Idle Driver used for Purge
Text Label 8900 2600 0    60   ~ 0
OilPressure
Text Label 7100 1300 0    60   ~ 0
GND
Text Label 10350 2800 0    60   ~ 0
Clutch
$Comp
L DIODE D1
U 1 1 4EA08EF7
P 10150 2800
F 0 "D1" H 10150 2900 40  0000 C CNN
F 1 "1N4001" H 10150 2700 40  0000 C CNN
F 2 "D4" H 10150 2800 60  0001 C CNN
	1    10150 2800
	1    0    0    -1  
$EndComp
$Comp
L MPX4250AP U3
U 1 1 4E9F35B8
P 10700 5400
F 0 "U3" H 10450 5750 60  0000 C CNN
F 1 "MPX4250AP" H 10600 5050 60  0000 C CNN
F 2 "MPX4250AP" H 10350 5650 60  0001 C CNN
	1    10700 5400
	1    0    0    -1  
$EndComp
Text Notes 7800 6900 0    60   ~ 0
External Connector
$Comp
L R R3
U 1 1 4E9BD276
P 9950 2550
F 0 "R3" V 10030 2550 50  0000 C CNN
F 1 "10K" V 9950 2550 50  0000 C CNN
F 2 "R4" H 9950 2550 60  0001 C CNN
	1    9950 2550
	-1   0    0    1   
$EndComp
Text Label 8900 2800 0    60   ~ 0
Launch
Text Label 8900 2200 0    60   ~ 0
CANL
Text Label 8900 2000 0    60   ~ 0
CANH
Text Label 7100 1700 2    60   ~ 0
sig4
Text Label 7100 1900 2    60   ~ 0
sig3
Text Label 7100 1600 2    60   ~ 0
sig2
Text Label 7100 1400 2    60   ~ 0
sig1
Text Label 8900 3500 0    60   ~ 0
WB
Text Label 9850 5350 0    60   ~ 0
Vref
Text Label 9850 5250 0    60   ~ 0
GND
Text Label 9850 5150 0    60   ~ 0
MAP
Text Label 8000 4650 0    60   ~ 0
GND
Text Label 8900 2100 0    60   ~ 0
FAN
Text Label 8900 1700 0    60   ~ 0
CEL
Text Label 7100 3650 0    60   ~ 0
IGN1
Text Label 7100 3400 0    60   ~ 0
IGN2
Text Label 8900 2700 0    60   ~ 0
FuelPressure
Text Label 9800 2050 3    60   ~ 0
5V
$Comp
L R R1
U 1 1 4E97EB9D
P 9350 2400
F 0 "R1" V 9430 2400 50  0000 C CNN
F 1 "470" V 9350 2400 50  0000 C CNN
F 2 "R4" H 9350 2400 60  0001 C CNN
	1    9350 2400
	0    1    1    0   
$EndComp
Text Label 9600 2900 0    60   ~ 0
12V
$Comp
L R R2
U 1 1 4E97EB45
P 9350 2900
F 0 "R2" V 9430 2900 50  0000 C CNN
F 1 "470" V 9350 2900 50  0000 C CNN
F 2 "R4" H 9350 2900 60  0001 C CNN
	1    9350 2900
	0    1    1    0   
$EndComp
Text Label 3150 3000 0    60   ~ 0
FuelPressure
Text Label 3150 3300 0    60   ~ 0
VSSSignal
Text Label 3150 3500 0    60   ~ 0
KnockSensor
Text Label 3150 3900 0    60   ~ 0
TACH
Text Label 3150 3800 0    60   ~ 0
CRANK
Text Label 3150 3700 0    60   ~ 0
Vref
Text Label 3150 3600 0    60   ~ 0
CAM
Text Label 3150 3400 0    60   ~ 0
CLT
Text Label 3150 3100 0    60   ~ 0
IAT
Text Label 3150 2450 0    60   ~ 0
FAN
Text Label 3150 1350 0    60   ~ 0
CEL
Text Label 1500 3250 2    60   ~ 0
INJ4
Text Label 1500 3150 2    60   ~ 0
INJ3
Text Label 1500 3050 2    60   ~ 0
INJ2
Text Label 1500 2950 2    60   ~ 0
INJ1
Text Label 1500 2250 2    60   ~ 0
FuelPump
Text Label 1500 2150 2    60   ~ 0
IAC
Text Label 1500 2050 2    60   ~ 0
Purge
Text Label 1500 1750 2    60   ~ 0
Clutch
Text Label 1500 1650 2    60   ~ 0
IGN2
Text Label 1500 1550 2    60   ~ 0
IGN1
Text Label 950  1350 0    60   ~ 0
TPS
Text Label 1500 1050 2    60   ~ 0
BIGGND
Text Label 1500 1250 2    60   ~ 0
GND
Text Label 1500 2350 2    60   ~ 0
12V
Text Label 3150 1150 0    60   ~ 0
12VRAW
Text Label 9100 1100 0    60   ~ 0
12VRAW
Text Label 8900 3600 0    60   ~ 0
TACH
Text Label 8900 3200 0    60   ~ 0
FuelPump
Text Label 8900 2500 0    60   ~ 0
Vref
Text Label 8900 3100 0    60   ~ 0
CRANK
Text Label 8900 2400 0    60   ~ 0
CAM
Text Label 8900 2300 0    60   ~ 0
TPS
Text Label 8900 1900 0    60   ~ 0
MAT
Text Label 8900 1500 0    60   ~ 0
CLT
$Comp
L USMODULE U2
U 1 1 4E967618
P 8050 2650
F 0 "U2" H 7650 4350 60  0000 C CNN
F 1 "USMODULE" H 8300 800 60  0000 C CNN
F 2 "USMODULE" H 8300 4350 60  0001 C CNN
	1    8050 2650
	1    0    0    -1  
$EndComp
$Comp
L ECU U1
U 1 1 4E9651F0
P 2150 2500
F 0 "U1" H 1900 4050 60  0000 C CNN
F 1 "ECU" H 2650 450 60  0000 C CNN
F 2 "MiataECU" H 2450 4050 60  0001 C CNN
	1    2150 2500
	1    0    0    -1  
$EndComp
$EndSCHEMATC
